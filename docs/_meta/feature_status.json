{
  "schema_version": 2,
  "last_updated": "2025-12-16",
  "features": {
    "face_alignment": {
      "title": "Face Alignment",
      "status": "partial",
      "created": "2025-12-11",
      "last_updated": "2025-12-13",
      "integrated_in_jobs": [
        "harvest"
      ],
      "integrated_in_autorun": true,
      "enabled_by_default": true,
      "how_to_enable": {
        "config_key": "config/pipeline/face_alignment.yaml:face_alignment.enabled",
        "ui_path": null,
        "cli_flag": "python -m FEATURES.face_alignment (legacy sandbox runner)"
      },
      "evidence_paths": [
        "tools/episode_run.py",
        "py_screenalytics/face_alignment/fan2d.py",
        "config/pipeline/face_alignment.yaml",
        "config/pipeline/embedding.yaml"
      ],
      "phases": {
        "A_FAN_2D": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "harvest"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": true,
          "how_to_enable": {
            "config_key": "config/pipeline/face_alignment.yaml:face_alignment.enabled",
            "ui_path": null,
            "cli_flag": "python -m FEATURES.face_alignment (legacy sandbox runner)"
          },
          "evidence_paths": [
            "py_screenalytics/face_alignment/fan2d.py",
            "tools/episode_run.py",
            "FEATURES/face_alignment/src/run_fan_alignment.py"
          ],
          "notes": "FAN 68-point alignment runs inside faces_embed when face_alignment.enabled=true. It writes runs/{run_id}/face_alignment/aligned_faces.jsonl and uses aligned crops for ArcFace embeddings. Requires optional dependency: face-alignment (pip install face-alignment)."
        },
        "B_LUVLi_quality_gate": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "harvest"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": true,
          "how_to_enable": {
            "config_key": "config/pipeline/face_alignment.yaml:face_alignment.quality_gate.enabled",
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [
            "tools/episode_run.py",
            "py_screenalytics/face_alignment/fan2d.py",
            "config/pipeline/face_alignment.yaml"
          ],
          "notes": "MVP alignment-quality gate implemented in faces_embed using deterministic heuristics from FAN landmarks (NOT a LUVLi model). Supports drop/downweight via face_alignment.quality_gate.*."
        },
        "C_3DDFA_V2": {
          "status": "not_started",
          "integrated_in_jobs": [],
          "integrated_in_autorun": false,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": null,
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [],
          "notes": "Planned only."
        }
      },
      "docs": [
        "docs/plans/in_progress/feature_face_alignment_fan_luvli_3ddfa.md",
        "docs/features/vision_alignment_and_body_tracking.md"
      ]
    },
    "body_tracking": {
      "title": "Body Tracking",
      "status": "partial",
      "created": "2025-12-11",
      "last_updated": "2025-12-16",
      "integrated_in_jobs": [
        "detect_track",
        "cluster"
      ],
      "integrated_in_autorun": true,
      "enabled_by_default": true,
      "how_to_enable": {
        "config_key": "config/pipeline/body_detection.yaml:body_tracking.enabled",
        "ui_path": null,
        "cli_flag": "python -m FEATURES.body_tracking"
      },
      "evidence_paths": [
        "FEATURES/body_tracking",
        "tools/episode_run.py",
        "config/pipeline/body_detection.yaml",
        "config/pipeline/track_fusion.yaml"
      ],
      "phases": {
        "sandbox_runner": {
          "status": "implemented_sandbox",
          "integrated_in_jobs": [],
          "integrated_in_autorun": false,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": null,
            "ui_path": null,
            "cli_flag": "python -m FEATURES.body_tracking"
          },
          "evidence_paths": [
            "FEATURES/body_tracking/src"
          ],
          "notes": "Sandbox pipeline exists; not enabled in production jobs or auto-run."
        },
        "pipeline_integration": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "detect_track"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": true,
          "how_to_enable": {
            "config_key": "config/pipeline/body_detection.yaml:body_tracking.enabled",
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [
            "tools/episode_run.py",
            "FEATURES/body_tracking/src/body_tracking_runner.py",
            "config/pipeline/body_detection.yaml"
          ],
          "notes": "Runs as a best-effort sub-step during detect_track; artifacts are run-scoped under data/manifests/{ep_id}/runs/{run_id}/body_tracking/."
        },
        "D_track_fusion": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "cluster"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": true,
          "how_to_enable": {
            "config_key": "config/pipeline/body_detection.yaml:body_tracking.enabled",
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [
            "tools/episode_run.py",
            "FEATURES/body_tracking/src/track_fusion.py",
            "FEATURES/body_tracking/src/screentime_compare.py",
            "config/pipeline/track_fusion.yaml"
          ],
          "notes": "Face↔body track fusion and screen-time comparison. Runs as best-effort post-processing after cluster stage completes. Generates track_fusion.json and screentime_comparison.json."
        },
        "E_unified_screentime": {
          "status": "implemented_production",
          "integrated_in_jobs": [],
          "integrated_in_autorun": true,
          "enabled_by_default": true,
          "how_to_enable": {
            "config_key": null,
            "ui_path": "Screentime page → Body Tracking tab",
            "cli_flag": null
          },
          "evidence_paths": [
            "apps/workspace-ui/pages/4_Screentime.py"
          ],
          "notes": "UI visibility breakdown showing face vs body screen time. Includes stacked bar chart, per-cast breakdown with body contribution %, and progress bars. Auto-displays when body_metrics_available=true."
        }
      },
      "docs": [
        "docs/plans/in_progress/feature_body_tracking_reid_fusion.md",
        "docs/features/vision_alignment_and_body_tracking.md"
      ]
    },
    "arcface_tensorrt": {
      "title": "ArcFace TensorRT",
      "status": "implemented_production",
      "created": "2025-12-11",
      "last_updated": "2025-12-16",
      "integrated_in_jobs": [
        "harvest"
      ],
      "integrated_in_autorun": true,
      "enabled_by_default": false,
      "how_to_enable": {
        "config_key": "config/pipeline/embedding.yaml:embedding.backend=tensorrt",
        "ui_path": null,
        "cli_flag": null
      },
      "evidence_paths": [
        "tools/episode_run.py",
        "FEATURES/arcface_tensorrt",
        "config/pipeline/arcface_tensorrt.yaml",
        "config/pipeline/embedding.yaml"
      ],
      "phases": {
        "A_engine_building": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "harvest"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": "config/pipeline/arcface_tensorrt.yaml",
            "ui_path": null,
            "cli_flag": "python -m FEATURES.arcface_tensorrt --mode build"
          },
          "evidence_paths": [
            "FEATURES/arcface_tensorrt/src/tensorrt_builder.py",
            "config/pipeline/arcface_tensorrt.yaml"
          ],
          "notes": "Engine build/load + local/S3 caching via build_or_load_engine(); invoked when embedding.backend=tensorrt."
        },
        "B_inference_wrapper": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "harvest"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": "config/pipeline/embedding.yaml:embedding.backend=tensorrt",
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [
            "tools/episode_run.py",
            "FEATURES/arcface_tensorrt/src/tensorrt_inference.py"
          ],
          "notes": "Batched inference wrapper used by faces_embed when enabled; falls back to PyTorch when TensorRT/PyCUDA/engine is unavailable."
        },
        "C_comparison": {
          "status": "implemented_production",
          "integrated_in_jobs": [],
          "integrated_in_autorun": false,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": null,
            "ui_path": null,
            "cli_flag": "python -m FEATURES.arcface_tensorrt --mode compare"
          },
          "evidence_paths": [
            "FEATURES/arcface_tensorrt/src/embedding_compare.py"
          ],
          "notes": "Parity harness: compares TensorRT vs PyTorch reference embeddings on a deterministic synthetic eval set."
        },
        "D_integration": {
          "status": "implemented_production",
          "integrated_in_jobs": [
            "harvest"
          ],
          "integrated_in_autorun": true,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": "config/pipeline/embedding.yaml:embedding.backend=tensorrt",
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [
            "tools/episode_run.py",
            "FEATURES/arcface_tensorrt"
          ],
          "notes": "Integrated into faces_embed (Harvest) and auto-run through embedding.backend selection; safe fallback to PyTorch on failure."
        }
      },
      "docs": [
        "docs/plans/in_progress/feature_arcface_tensorrt_onnxruntime.md",
        "docs/features/vision_alignment_and_body_tracking.md"
      ]
    },
    "vision_analytics": {
      "title": "Vision Analytics",
      "status": "not_started",
      "created": "2025-12-11",
      "last_updated": "2025-12-13",
      "integrated_in_jobs": [],
      "integrated_in_autorun": false,
      "enabled_by_default": false,
      "how_to_enable": {
        "config_key": null,
        "ui_path": null,
        "cli_flag": null
      },
      "evidence_paths": [
        "FEATURES/vision_analytics"
      ],
      "phases": {
        "all": {
          "status": "not_started",
          "integrated_in_jobs": [],
          "integrated_in_autorun": false,
          "enabled_by_default": false,
          "how_to_enable": {
            "config_key": null,
            "ui_path": null,
            "cli_flag": null
          },
          "evidence_paths": [],
          "notes": "Docs/config only."
        }
      },
      "docs": ["docs/features/vision_alignment_and_body_tracking.md"]
    }
  }
}
